function GetData(){return{StoreID:$("#WorkObjName").val()}}function OnClickClose(){var n={},i=[],d=validateEmail($("#EmailID").val()),g=$("#WorkObjName").val(),nt=$("#EmailID").val(),tt=$("#UserID").val(),it=$("#Password").val(),rt=$("#MailServerTypeID").val(),e=!1,ut=$("#ScheduleInterval").val(),ft=$("#AutoReplyTemplate").val(),et=$("#AutoDiscoveryPath").val(),ot=$("#NFSFilePath").val(),st=$("#WebServerURL").val(),ht=$("#LotusServerPath").val(),ct=$("#LotusDomainName").val(),lt=$("#LotusDomainPrefix").val(),o=$("#formSearchView input").val(),dt=$("#ClientName").val(),gt=$("#ProcessName").val(),at=$("#CampaignName").val(),vt=$("#MailConfigID").val(),yt=$("#FolderType").val(),r=!1,s=!1,pt=$("#MailBoxName").val(),h=!1,c=!1,l=!1,a=!1,v=!1,wt=$("#sOutofOffice").val(),y=!1,p=!1,w=!1,bt=$("#sImpersonationIDType").val(),kt=$("#sImpersonationID").val(),u=$("#grdSubFolder").data("kendoGrid"),b,f,t,k;if(u!=undefined&&(b=u.tbody.find("tr"),t=0,b.each(function(){var n=u.dataItem($(this));n.Ingestion=$("#grdSubFolder tbody").find("tr").eq(t).find("td").eq(3).find("input").is(":checked");n.Search=$("#grdSubFolder tbody").find("tr").eq(t).find("td").eq(4).find("input").is(":checked");n.MoveFolder=$("#grdSubFolder tbody").find("tr").eq(t).find("td").eq(5).find("input").is(":checked");n.Disable=$("#grdSubFolder tbody").find("tr").eq(t).find("td").eq(6).find("input").is(":checked");i.push(n);t++})),l=$("#Disable").is(":checked")?!0:!1,e=$("#ServiceType").is(":checked")?!0:!1,w=$("#bImpersonation").is(":checked")?!0:!1,r=$("#UseServiceCredentialToPull").is(":checked")?!0:!1,s=$("#UseUserCredentialToSend").is(":checked")?!0:!1,h=$("#AutoReplyEnableDisable").is(":checked")?!0:!1,c=$("#IsReadMail").is(":checked")?!0:!1,a=$("#WebEnabled").is(":checked")?!0:!1,v=$("#bOutofOfficeEnabled").is(":checked")?!0:!1,y=$("#bOutLookEnabled").is(":checked")?!0:!1,p=$("#bTranslationEnabled").is(":checked")?!0:!1,$("#MailServerTypeID").val()=="")return jAlert(display_PleaseSelectExchangeServerType,"Alert",function(){$("#MailServerTypeID").focus()}),!1;if($("#MailBoxName").val()=="")return jAlert(display_PleaseEnterMailBoxName,"Alert",function(){$("#MailBoxName").focus()}),!1;if(!d&&r==!1)return jAlert(display_PleaseEnterEmailID,"Alert",function(){$("#EmailID").focus()}),!1;if($("#EmailID").val()==""&&r==!1)return jAlert(display_PleaseEnterEmailID,"Alert",function(){$("#EmailID").focus()}),!1;if($("#UserID").val()==""&&r==!1)return jAlert(display_PleaseEnterUserID,"Alert",function(){$("#UserID").focus()}),!1;if($("#Password").val()==""&&r==!1)return jAlert(display_PleaseEnterPassword,"Alert",function(){$("#Password").focus()}),!1;if($("#ScheduleInterval").val()=="")return jAlert(display_PleaseEnterScheduleInterval,"Alert",function(){$("#ScheduleInterval").focus()}),!1;if($("#WebServerURL").val()=="")return jAlert(display_PleaseEnterWebServerURL,"Alert",function(){$("#WebServerURL").focus()}),!1;if($("#MailServerTypeID").val()=="0"){if($("#LotusServerPath").val()=="")return jAlert(display_PleaseEnterLotusServerPath,display_Alert,function(){$("#LotusServerPath").focus()}),!1;if($("#NFSFilePath").val()=="")return jAlert(display_PleaseEnterNFSFilePath,display_Alert,function(){$("#NFSFilePath").focus()}),!1}if(n.MailConfigID=vt,n.StoreID=g,n.CampaignID=at,n.MailBoxName=pt,n.EmailID=nt,n.UserID=tt,n.Password=it,n.MailServerTypeID=rt,n.ServiceType=e,n.ScheduleInterval=ut,n.AutoReplyTemplate=ft,n.AutoReplyEnableDisable=h,n.AutoDiscoveryPath=et,n.LotusServerPath=ht,n.LotusDomainName=ct,n.LotusDomainPrefix=lt,n.NFSFilePath=ot,n.WebEnabled=a,n.bOutofOfficeEnabled=v,n.bOutLookEnabled=y,n.bTranslationEnabled=p,n.sOutofOffice=wt,n.WebServerURL=st,n.IsReadMail=c,n.UseServiceCredentialToPull=r,n.bImpersonation=w,n.sImpersonationID=kt,n.sImpersonationIDType=bt,n.UseUserCredentialToSend=s,n.FolderType=yt,n.Disable=l,f=[],i!=undefined)for(t=0;t<i.length;t++)k={MailFolderDetailID:i[t].MailFolderDetailID,Id:i[t].Id,Name:i[t].Name,Search:i[t].Search,MoveFolder:i[t].MoveFolder,Ingestion:i[t].Ingestion,Disable:i[t].Disable,MailFolderPath:i[t].MailFolderPath},f.push(k);o=$("#form1 input").val();$.ajax({type:"Post",url:ResourceLayout.partialURL+"InsertUpdateMailConfiguration",data:{__RequestVerificationToken:o,objMailConfigurationViewModel:n,JData:f},dataType:"json",success:function(n){var t=n.split(",")[1];t=="OK"?(jAlert(n.split(",")[0]),$("#gridMailConfig").data("kendoGrid").dataSource.read(),$("#SearchViewPopUp").closest(".k-window-content").data("kendoWindow").close()):jAlert(n)},error:function(){jAlert(display_SomethingWrongHappenedContactAdmin);$("#load").toggle()}})}function gvConfiguration_Click(){var n,t,i;if($("#ClientName").val()=="")return $("#ClientName").focus(),!1;if($("#ProcessName").val()=="")return $("#ProcessName").focus(),!1;if($("#CampaignName").val()=="")return $("#CampaignName").focus(),!1;n={};t=$("#CampaignName").val();n.CampaignID=t;n.MailConfigID=1;i=$("#form1 input").val();$.ajax({type:"Post",url:ResourceLayout.partialURL+"SetConfigurationID",data:{__RequestVerificationToken:i,objMailConfigurationViewModel:n},dataType:"json",success:function(n){n=="1"&&$("#AdvanceConfigurationPopUp").data("kendoWindow").title(display_EMSAdvancedConfiguration).refresh({url:ResourceLayout.partialURL+"AdvanceConfigurationPopUp"}).center().open()},error:function(){jAlert(display_SomethingWrongHappenedContactAdmin,display_Alert);$("#load").toggle()}})}function OnClickSaveAdvnaceConfig(){var n={},t=!1,i=!1,r=!1,u,f;if($("#bScheduletosameuser").is(":checked")&&(t=!0),$("#bSendmailquiqueidentified").is(":checked")&&(i=!0),$("#bInlineEditing").is(":checked")&&(r=!0),u=$("#CampaignName").val(),n.CampaignID=u,n.bScheduletosameuser=t,n.bSendmailquiqueidentified=i,n.bInlineEditing=r,n.BatchFrequencyType=$("#BatchFrequencyType").val(),n.iTimeZoneID=$("#iTimeZoneID").val(),n.BatchFrequencyType==""||n.BatchFrequencyType==undefined)return jAlert(msg_SelectBatchFrequency,display_Alert),!1;f=$("#form1 input").val();$.ajax({type:"Post",url:ResourceLayout.partialURL+"InsertUpdateAdvancedConfiguration",data:{__RequestVerificationToken:f,objMailConfigurationViewModel:n},dataType:"json",success:function(n){jAlert(n,display_Alert);$("#AdvanceConfigurationPopUp").closest(".k-window-content").data("kendoWindow").close()},error:function(){jAlert(display_SomethingWrongHappenedContactAdmin,display_Alert);$("#load").toggle()}})}function gvAddrow_Click(){if($("#ClientName").val()=="")return $("#ClientName").focus(),!1;if($("#ProcessName").val()=="")return $("#ProcessName").focus(),!1;if($("#CampaignName").val()=="")return $("#CampaignName").focus(),!1;$("#SearchViewPopUp").data("kendoWindow").title(display_EMSMailConfiguration).refresh({url:ResourceLayout.partialURL+"SearchViewPopUp"}).center().open();$("#grdSubFolder").html("")}function editRow(n){var i={},r;n.preventDefault();var t=this.dataItem($(n.currentTarget).closest("tr")),u=t.iMailConfigID,f=t.sEmailID,e=t.sUserID,o=t.sPassword,s=t.bUseServiceCredentialToPull,h=t.bUseUserCredentialToSend,c=t.iMailServerTypeID,l=t.sAutoDiscoveryPath,a=t.sLotusServerPath,v=t.sLotusDomainName,y=t.sLotusDomainPrefix,p=t.sNFSFilePath,w=t.bWebEnabled,b=t.bEMSWebServerHosting,k=t.EMSWebServerURL,d=t.isPasswordExpire,g=t.AutoReply,nt=t.MailTemplateID,tt=t.PoolingValue,it=t.IsReadMail,rt=t.iFolderType,ut=t.sMailBoxName,ft=t.iScheduleInterval,et=t.bDisabled,ot=t.iCampaignID,st=t.bOutofOfficeEnabled,ht=t.bOutLookEnabled,ct=t.bTranslationEnabled,lt=t.sOutofOffice,at=t.bImpersonation,vt=t.sImpersonationIDType,yt=t.sImpersonationID;i.MailConfigID=u;r=$("#form1 input").val();$.ajax({type:"Post",url:ResourceLayout.partialURL+"SetConfigurationID",data:{__RequestVerificationToken:r,objMailConfigurationViewModel:i},dataType:"json",success:function(n){n=="1"&&$("#SearchViewPopUp").data("kendoWindow").title(display_EMSMailConfiguration).refresh({url:ResourceLayout.partialURL+"SearchViewPopUp"}).center().open()},error:function(){}})}function OnChangeMailServerTypeID(){var n=[{Text:"Primary",Value:"1"},{Text:"Shared Mailbox",Value:"2"},{Text:"Public Folder",Value:"3"}];$("#AutoDiscoveryPath").val("");$("#MailServerTypeID").val()=="0"?($("#MainTable .Lotus").show(),$("#MainTable .Outlook").hide(),$("#FolderType").kendoDropDownList({dataTextField:"Text",dataValueField:"Value",dataSource:[{Text:"Primary",Value:"1"}],index:0})):$("#MailServerTypeID").val()=="4"?($("#AutoDiscoveryPath").val(display_office365Exchange),$("#MainTable .Lotus").hide(),$("#MainTable .Outlook").show(),$("#FolderType").kendoDropDownList({dataTextField:"Text",dataValueField:"Value",dataSource:n,index:0})):($("#MailServerTypeID").val()=="1"||$("#MailServerTypeID").val()=="2"||$("#MailServerTypeID").val()=="3")&&($("#MainTable .Lotus").hide(),$("#MainTable .Outlook").show(),$("#FolderType").kendoDropDownList({dataTextField:"Text",dataValueField:"Value",dataSource:n,index:0}));$("#MailServerTypeID").val()==""&&($("#FolderType").kendoDropDownList({dataTextField:"Text",dataValueField:"Value",dataSource:n,index:0}),$("#MainTable .Lotus").hide(),$("#MainTable .Outlook").hide())}function Call(){$("#treeViewSearchInput").css({background:"whitesmoke"})}function checkedNodeIds(n,t,i,r){for(var u=0;u<n.length;u++)n[u].checked&&(t.push(n[u].text),i.push(n[u].id),r.push(n[u].parentId)),n[u].hasChildren&&checkedNodeIds(n[u].children.view(),t,i,r)}function onCheck(n){var t=[],u=$("#grdSubFolder").data("kendoGrid"),f,e,i,r;if($("#treeview").data("kendoTreeView").dataItem(n.node).checked)u!=undefined?(i=u.dataSource,f={Id:$("#treeview").data("kendoTreeView").dataItem(n.node).id,MailFolderPath:$("#treeview").data("kendoTreeView").dataItem(n.node).parentId,Name:$("#treeview").data("kendoTreeView").dataItem(n.node).text,Ingestion:!1,Search:!1,MoveFolder:!1,Disable:!1},i.insert(u.dataSource.length+1,f)):($("#grdSubFolder").css("width","600"),$("#grdSubFolder").css("height","300"),$("#grdSubFolder").html(""),f={Id:$("#treeview").data("kendoTreeView").dataItem(n.node).id,MailFolderPath:$("#treeview").data("kendoTreeView").dataItem(n.node).parentId,Name:$("#treeview").data("kendoTreeView").dataItem(n.node).text,Ingestion:!1,Search:!1,MoveFolder:!1,Disable:!1},e=new kendo.data.DataSource({pageSize:20,data:f,autoSync:!0,schema:{model:{Id:"Id",fields:{Id:{editable:!1},MailFolderPath:{editable:!1},Name:{editable:!1},Ingestion:{type:"boolean"},Search:{type:"boolean"},MoveFolder:{type:"boolean"},Disable:{type:"boolean"}}}}}),t.push({field:"Id",hidden:!0,width:30}),t.push({field:"MailFolderPath",hidden:!0,width:30}),t.push({field:"Name",width:230,title:display_Name}),t.push({field:"Ingestion",title:display_Ingestion,width:85,template:'<input type="checkbox" class="chkIngestion"  #= Ingestion ? checked="checked" : "" #  />'}),t.push({field:"Search",title:display_Search,width:80,template:'<input type="checkbox" class="chkSearch" #= Search ? checked="checked" : "" #  />'}),t.push({field:"MoveFolder",title:display_MoveFolder,width:100,template:'<input type="checkbox" class="chkMoveFolder" #= MoveFolder ? checked="checked" : "" # />'}),t.push({field:"Disable",title:display_Disable,width:80,template:'<input type="checkbox" class="chkDisable"   #= Disable ? checked="checked" : "" # />'}),$("#grdSubFolder").kendoGrid({columns:t,dataSource:e,height:300,editable:!0,filterable:!0,autoBind:!0}),$("#grdSubFolder").kendoTooltip({filter:"td:nth-child(3)",position:"right",content:function(n){var t=$("#grdSubFolder").data("kendoGrid").dataItem(n.target.closest("tr"));return t.MailFolderPath}}).data("kendoTooltip"));else{for(i=u.dataSource,r=0;r<i.data().length;r++)if($("#treeview").data("kendoTreeView").dataItem(n.node).id==i.data()[r].Id){i.remove(i.data()[r]);break}i.data().length==0&&($("#grdSubFolder").css("width","400"),$("#grdSubFolder").css("height","300"),$("#grdSubFolder").data("kendoGrid").destroy(),$("#grdSubFolder").html(""))}}function onExpand(n){var e=!1,u,r,f,c,o,s,h,w;if(objModel.length!=0)for(u=0;u<objModel.length;u++)if($("#treeview").data("kendoTreeView").dataItem(n.node).id==objModel[u].id){e=!0;break}else e=!1;if(!e){objModel.push({id:$("#treeview").data("kendoTreeView").dataItem(n.node).id});r=$("#treeview").data("kendoTreeView");r.select(n.node);f=r.select();c=$(".k-item",n.node);r.remove(c);var gt=$("#UserID").val(),ni=$("#Password").val(),ti=$("#EmailID").val(),b=$("#MailServerTypeID").val(),k=$("#AutoDiscoveryPath").val(),ii=$("#FolderType").val(),ri=$("#LotusServerPath").val(),d=$("#LotusDomainName").val(),g=$("#LotusDomainPrefix").val(),ui=$("#NFSFilePath").val(),nt=validateEmail($("#EmailID").val()),t={},fi=$("#ClientName").val(),ei=$("#ProcessName").val(),tt=$("#CampaignName").val(),it=$("#MailConfigID").val(),rt=$("#FolderType").val(),i=!1,l=!1,ut=$("#MailBoxName").val(),ft=$("#sOutofOffice").val(),a=!0,v=!0,y=!1,p=!1,et=$("#sImpersonationIDType").val(),ot=$("#sImpersonationID").val();p=$("#bImpersonation").is(":checked")?!0:!1;o=!1;o=$("#bOutofOfficeEnabled").is(":checked")?!0:!1;s=!1;s=$("#bOutLookEnabled").is(":checked")?!0:!1;h=!1;h=$("#bTranslationEnabled").is(":checked")?!0:!1;y=$("#Disable").is(":checked")?!0:!1;i=$("#UseServiceCredentialToPull").is(":checked")?!0:!1;l=$("#UseUserCredentialToSend").is(":checked")?!0:!1;a=$("#AutoReplyEnableDisable").is(":checked")?!0:!1;v=$("#IsReadMail").is(":checked")?!0:!1;var st=$("#EmailID").val(),ht=$("#UserID").val(),ct=$("#Password").val(),lt=$("#MailServerTypeID").val(),at=$("#ServiceType").val(),vt=$("#ScheduleInterval").val(),yt=$("#AutoReplyTemplate").val(),pt=$("#AutoDiscoveryPath").val(),wt=$("#LotusServerPath").val(),d=$("#LotusDomainName").val(),g=$("#LotusDomainPrefix").val(),bt=$("#NFSFilePath").val(),kt=$("#WebEnabled").val(),dt=$("#WebServerURL").val();if($("#MailServerTypeID").val()=="")return jAlert(display_PleaseSelectExchangeServerType,display_Alert,function(){$("#MailServerTypeID").focus()}),!1;if($("#FolderType").val()=="")return jAlert(display_PleaseSelectFolderType,display_Alert,function(){$("#FolderType").focus()}),!1;if($("#MailBoxName").val()=="")return jAlert(display_PleaseEnterMailBoxName,display_Alert,function(){$("#MailBoxName").focus()}),!1;if(!nt&&i==!1)return jAlert(display_PleaseEnterEmailID,display_Alert,function(){$("#EmailID").focus()}),!1;if($("#EmailID").val()==""&&i==!1)return jAlert(display_PleaseEnterEmailID,display_Alert,function(){$("#EmailID").focus()}),!1;if($("#UserID").val()==""&&i==!1)return jAlert(display_PleaseEnterUserID,display_Alert,function(){$("#UserID").focus()}),!1;if($("#Password").val()==""&&i==!1)return jAlert(display_PleaseEnterPassword,display_Alert,function(){$("#Password").focus()}),!1;if($("#ScheduleInterval").val()=="")return jAlert(display_PleaseEnterScheduleInterval,display_Alert,function(){$("#ScheduleInterval").focus()}),!1;if(b!=0&&k=="")return jAlert(required_AutoDiscoveryPath,display_Alert,function(){$("#AutoDiscoveryPath").focus()}),!1;if($("#MailServerTypeID").val()==display_DominoServer){if($("#LotusServerPath").val()=="")return jAlert(display_PleaseEnterLotusServerPath,display_Alert,function(){$("#LotusServerPath").focus()}),!1;if($("#NFSFilePath").val()=="")return jAlert(display_PleaseEnterNFSFilePath,display_Alert,function(){$("#NFSFilePath").focus()}),!1}t.MailConfigID=it;t.CampaignID=tt;t.MailBoxName=ut;t.EmailID=st;t.UserID=ht;t.Password=ct;t.MailServerTypeID=lt;t.ServiceType=at;t.ScheduleInterval=vt;t.AutoReplyTemplate=yt;t.AutoReplyEnableDisable=a;t.AutoDiscoveryPath=pt;t.LotusServerPath=wt;t.LotusDomainName=d;t.LotusDomainPrefix=g;t.NFSFilePath=bt;t.WebEnabled=kt;t.bOutofOfficeEnabled=o;t.bOutLookEnabled=s;t.bTranslationEnabled=h;t.sOutofOffice=ft;t.WebServerURL=dt;t.IsReadMail=v;t.UseServiceCredentialToPull=i;t.UseUserCredentialToSend=l;t.bImpersonation=p;t.sImpersonationID=ot;t.sImpersonationIDType=et;t.FolderType=rt;t.Disable=y;t.FolderID=$("#treeview").data("kendoTreeView").dataItem(n.node).id;t.ParentFolderName=$("#treeview").data("kendoTreeView").dataItem(n.node).parentId;w=$("#form1 input").val();$.ajax({type:"Post",url:ResourceLayout.partialURL+"GetNodeValue",data:{__RequestVerificationToken:w,objMailConfigurationViewModel:t},dataType:"json",success:function(t){var i,u;for(f.length==0&&(f=null),i=0;i<t.lst.length;i++)r.append({id:t.lst[i].id,text:t.lst[i].text,parentId:t.lst[i].parentId,items:t.lst[i].items},f);if($("#grdSubFolder").data("kendoGrid")!=undefined&&$("#grdSubFolder").data("kendoGrid").dataSource!=undefined&&$("#grdSubFolder").data("kendoGrid").dataSource.data()!=undefined)for(i=0;i<$("#grdSubFolder").data("kendoGrid").dataSource.data().length;i++)for(u=0;u<$("#treeview").data("kendoTreeView").dataItem(n.node).items.length;u++)$("#treeview").data("kendoTreeView").dataItem(n.node).items[u]!=undefined&&$("#grdSubFolder").data("kendoGrid").dataSource.data()[i].Id==$("#treeview").data("kendoTreeView").dataItem(n.node).items[u].id&&$("#treeview").data("kendoTreeView").dataItem(n.node).items[u].set("checked",!0)}})}}function GetTemplateValue(){return{isDisabled:$("#Disable").is(":checked"),isAutoReply:$("#AutoReplyEnableDisable").is(":checked")}}function validateEmail(n){return/^\s*[\w\-\+_]+(\.[\w\-\+_]+)*\@[\w\-\+_]+\.[\w\-\+_]+(\.[\w\-\+_]+)*\s*$/.test(n.replace(/^\s+|\s+$/gm,""))?!0:!1}var checkedNodeValues=[],objModel;$("#bScheduletosameuser").prop("disabled",!0);$("#bSendmailquiqueidentified").is(":checked")&&$("#bScheduletosameuser").prop("disabled",!1);$("#bSendmailquiqueidentified").click(function(){$(this).is(":checked")?$("#bScheduletosameuser").prop("disabled",!1):($("#bScheduletosameuser").prop("disabled",!0),$("#bScheduletosameuser").prop("checked",!1))});$(document).ready(function(){var v,y,i,u,vt,yt,a;if($("#MailConfigID").val()!="0"&&$("#MailConfigID").val()!=undefined){v=window.location.pathname;y=window.location.href;$("#treeview").html("");var n={},t=[];t.push({field:"Id",hidden:!0,width:30});t.push({field:"MailFolderPath",hidden:!0,width:30});t.push({field:"Name",width:230,title:display_Name});t.push({field:"Ingestion",title:display_Ingestion,width:85,template:'<input type="checkbox" class="chkIngestion"  #= Ingestion ? checked="checked" : "" #  />'});t.push({field:"Search",title:display_Search,width:80,template:'<input type="checkbox" class="chkSearch" #= Search ? checked="checked" : "" #  />'});t.push({field:"MoveFolder",title:display_MoveFolder,width:100,template:'<input type="checkbox" class="chkMoveFolder" #= MoveFolder ? checked="checked" : "" # />'});t.push({field:"Disable",title:display_Disable,width:80,template:'<input type="checkbox" class="chkDisable"   #= Disable ? checked="checked" : "" # />'});$("#MailServerTypeID").val()==0?($("#MainTable .Lotus").show(),$("#MainTable .Outlook").hide()):$("#MailServerTypeID").val()!=0&&($("#MainTable .Lotus").hide(),$("#MainTable .Outlook").show());$("#MailServerTypeID").val()==""&&($("#MainTable .Lotus").hide(),$("#MainTable .Outlook").hide());var f=!1,pt=$("#ClientName").val(),wt=$("#ProcessName").val(),p=$("#CampaignName").val(),w=$("#MailConfigID").val(),e=$("#FolderType").val(),o=!1,s=!1,b=$("#MailBoxName").val(),h=!0,k=$("#sOutofOffice").val(),c=!0,l=!1;l=$("#bOutofOfficeEnabled").is(":checked")?!0:!1;i=!1;i=$("#bOutLookEnabled").is(":checked")?!0:!1;bTranslationEnabled=$("#bTranslationEnabled").is(":checked")?!0:!1;var r=!1,d=$("#sImpersonationIDType").val(),g=$("#sImpersonationID").val();$("#bImpersonation").is(":checked")?(r=!0,$("#MainTable .ImpersonationID").show(),$("#MainTable .ImpersonationIDType").show()):(r=!1,$("#MainTable .ImpersonationID").hide(),$("#MainTable .ImpersonationIDType").hide());u=!1;u=$("#Disable").is(":checked")?!0:!1;o=$("#UseServiceCredentialToPull").is(":checked")?!0:!1;s=$("#UseUserCredentialToSend").is(":checked")?!0:!1;h=$("#AutoReplyEnableDisable").is(":checked")?!0:!1;c=$("#IsReadMail").is(":checked")?!0:!1;f=$("#ServiceType").is(":checked")?!0:!1;var nt=$("#EmailID").val(),tt=$("#UserID").val(),it=$("#Password").val(),rt=$("#MailServerTypeID").val(),ut=$("#ScheduleInterval").val(),ft=$("#AutoReplyTemplate").val(),et=$("#AutoDiscoveryPath").val(),ot=$("#NFSFilePath").val(),st=$("#WebEnabled").val(),ht=$("#WebServerURL").val(),ct=$("#LotusServerPath").val(),lt=$("#LotusDomainName").val(),at=$("#LotusDomainPrefix").val(),k=$("#sOutofOffice").val(),d=$("#sImpersonationIDType").val(),g=$("#sImpersonationID").val();$("#MailServerTypeID").val()=="0"?($("#MainTable .Lotus").show(),$("#MainTable .Outlook").hide(),$("#FolderType").kendoDropDownList({dataTextField:"Text",dataValueField:"Value",dataSource:[{Text:"Primary",Value:"1"}],index:0})):($("#MailServerTypeID").val()=="1"||$("#MailServerTypeID").val()=="2"||$("#MailServerTypeID").val()=="3")&&($("#MainTable .Lotus").hide(),$("#MainTable .Outlook").show(),$("#FolderType").kendoDropDownList({dataTextField:"Text",dataValueField:"Value",dataSource:[{Text:"Primary",Value:"1"},{Text:"Shared Mailbox",Value:"2"},{Text:"Public Folder",Value:"3"}],index:0}));$("#sImpersonationIDType").kendoDropDownList({dataTextField:"Text",dataValueField:"Value",dataSource:[{Text:"Select",Value:"0"},{Text:"PrincipalName",Value:"1"},{Text:"SID",Value:"2"},{Text:"SmtpAddress",Value:"3"}],index:0});$("#MailBoxName").prop("disabled",!0);$("#UseServiceCredentialToPull").is(":checked")?($("#UserID").val(""),$("#UserID").prop("disabled",!0),$("#Password").val(""),$("#Password").prop("disabled",!0),$("#EmailID").val(""),$("#EmailID").prop("disabled",!0),$("#grdSubFolder").html(""),$("#treeview").html()!=""&&$("#treeview").data("kendoTreeView").dataSource.data([])):($("#UserID").prop("disabled",!1),$("#Password").prop("disabled",!1),$("#EmailID").prop("disabled",!1));n.MailConfigID=w;n.CampaignID=p;n.MailBoxName=b;n.EmailID=nt;n.UserID=tt;n.Password=it;n.MailServerTypeID=rt;n.ServiceType=f;n.ScheduleInterval=ut;n.AutoReplyTemplate=ft;n.AutoReplyEnableDisable=h;n.AutoDiscoveryPath=et;n.LotusServerPath=ct;n.LotusDomainName=lt;n.LotusDomainPrefix=at;n.NFSFilePath=ot;n.WebEnabled=st;n.WebServerURL=ht;n.IsReadMail=c;n.UseServiceCredentialToPull=o;n.UseUserCredentialToSend=s;n.FolderType=e;n.bOutofOfficeEnabled=l;n.bOutLookEnabled=i;n.bTranslationEnabled=bTranslationEnabled;n.sOutofOffice=k;n.bImpersonation=r;n.sImpersonationID=g;n.sImpersonationIDType=d;vt=$("#FolderType").data("kendoDropDownList");yt=function(n){(n.type!="keypress"||kendo.keys.ENTER==n.keyCode)&&dropdownlist.Value(e)};n.Disable=u;a=$("#formSearchView input").val();$("#load").show();$.ajax({type:"POST",url:ResourceLayout.partialURL+"TestConnection",data:{__RequestVerificationToken:a,objMailConfigurationViewModel:n},dataType:"json",success:function(n){var i,f,r,e,o,s,u;if(n.Data!=undefined){if(n.erorVal=="ERROR")jAlert(n.ErrorMessage,display_Alert),$("#load").toggle();else for($("#treeview").kendoTreeView({animation:!1,checkboxes:!0,dataSource:n.lst,check:onCheck,expand:onExpand}),i=$("#treeview").data("kendoTreeView"),f=n.Data,r=0;r<f.length;r++)for(e=0;e<i.dataSource.view().length;e++)u=i.dataSource,o=u.get(f[r].Id),o!=undefined&&(s=i.dataSource.getByUid(o.uid),s&&s.set("checked",!0));n.Data.length>0?($("#grdSubFolder").css("width","600"),$("#grdSubFolder").css("height","300"),$("#grdSubFolder").html(""),u=new kendo.data.DataSource({pageSize:20,data:n.Data,autoSync:!0,schema:{model:{Id:"Id",fields:{Id:{editable:!1},MailFolderPath:{editable:!1},Name:{editable:!1},Ingestion:{type:"boolean"},Search:{type:"boolean"},MoveFolder:{type:"boolean"},Disable:{type:"boolean"}}}}}),$("#grdSubFolder").kendoGrid({columns:t,dataSource:u,height:300,editable:!0,filterable:!0,autoBind:!0})):$("#grdSubFolder").html("")}$("#load").hide();$(".k-in").css("border-left-width: 10px;")},error:function(){jAlert(display_SomethingWrongHappenedContactAdmin,display_Alert);$("#load").toggle()}})}});$("#UseServiceCredentialToPull").click(function(){$("#UseServiceCredentialToPull").is(":checked")?($("#UserID").val(""),$("#UserID").prop("disabled",!0),$("#Password").val(""),$("#Password").prop("disabled",!0),$("#grdSubFolder").html(""),$("#treeview").html()!=""&&$("#treeview").data("kendoTreeView").dataSource.data([])):($("#UserID").prop("disabled",!1),$("#Password").prop("disabled",!1),$("#EmailID").prop("disabled",!1))});$("#UseUserCredentialToSend").click(function(){$("#UseServiceCredentialToPull").is(":checked")});$("#bImpersonation").click(function(){$("#bImpersonation").is(":checked")?($("#MainTable .ImpersonationID").show(),$("#MainTable .ImpersonationIDType").show()):($("#MainTable .ImpersonationID").hide(),$("#MainTable .ImpersonationIDType").hide(),$("#sImpersonationID").val(" "))});$("#AutoReplyEnableDisable").click(function(){$("#AutoReplyTemplate").data("kendoDropDownList").dataSource.read()});objModel=[];$("#BtnTestConnection").unbind("click").click(function(){var i,l,r,u,yt,a;objModel=[];var pt=$("#UserID").val(),wt=$("#Password").val(),bt=$("#EmailID").val(),v=$("#MailServerTypeID").val(),y=$("#AutoDiscoveryPath").val(),kt=$("#FolderType").val(),dt=$("#LotusServerPath").val(),p=$("#LotusDomainName").val(),w=$("#LotusDomainPrefix").val(),gt=$("#NFSFilePath").val(),b=validateEmail($("#EmailID").val()),n={},ni=$("#ClientName").val(),ti=$("#ProcessName").val(),k=$("#CampaignName").val(),f=$("#MailConfigID").val(),d=$("#FolderType").val(),t=!1,e=!1,g=$("#MailBoxName").val(),o=!0,s=!0,h=!1,c=!1,nt=$("#sImpersonationIDType").val(),tt=$("#sImpersonationID").val();c=$("#bImpersonation").is(":checked")?!0:!1;i=!1;l=$("#sOutofOffice").val();i=$("#bOutofOfficeEnabled").is(":checked")?!0:!1;r=!1;r=$("#bOutLookEnabled").is(":checked")?!0:!1;u=!1;u=$("#bTranslationEnabled").is(":checked")?!0:!1;h=$("#Disable").is(":checked")?!0:!1;t=$("#UseServiceCredentialToPull").is(":checked")?!0:!1;e=$("#UseUserCredentialToSend").is(":checked")?!0:!1;o=$("#AutoReplyEnableDisable").is(":checked")?!0:!1;s=$("#IsReadMail").is(":checked")?!0:!1;var it=$("#EmailID").val(),rt=$("#UserID").val(),ut=$("#Password").val(),ft=$("#MailServerTypeID").val(),et=$("#ServiceType").val(),ot=$("#ScheduleInterval").val(),st=$("#AutoReplyTemplate").val(),ht=$("#AutoDiscoveryPath").val(),ct=$("#LotusServerPath").val(),p=$("#LotusDomainName").val(),w=$("#LotusDomainPrefix").val(),lt=$("#NFSFilePath").val(),at=$("#WebEnabled").val(),vt=$("#WebServerURL").val();if($("#MailServerTypeID").val()=="")return jAlert(display_PleaseSelectExchangeServerType,display_Alert,function(){$("#MailServerTypeID").focus()}),!1;if($("#FolderType").val()=="")return jAlert(display_PleaseSelectFolderType,display_Alert,function(){$("#FolderType").focus()}),!1;if($("#MailBoxName").val()=="")return jAlert(display_PleaseEnterMailBoxName,display_Alert,function(){$("#MailBoxName").focus()}),!1;if(!b&&t==!1)return jAlert(display_PleaseEnterEmailID,display_Alert,function(){$("#EmailID").focus()}),!1;if($("#EmailID").val()==""&&t==!1)return jAlert(display_PleaseEnterEmailID,display_Alert,function(){$("#EmailID").focus()}),!1;if($("#UserID").val()==""&&t==!1)return jAlert(display_PleaseEnterUserID,display_Alert,function(){$("#UserID").focus()}),!1;if($("#Password").val()==""&&t==!1)return jAlert(display_PleaseEnterPassword,display_Alert,function(){$("#Password").focus()}),!1;if($("#ScheduleInterval").val()=="")return jAlert(display_PleaseEnterScheduleInterval,display_Alert,function(){$("#ScheduleInterval").focus()}),!1;if(v!=0&&y=="")return jAlert(required_AutoDiscoveryPath,display_Alert,function(){$("#AutoDiscoveryPath").focus()}),!1;if($("#MailServerTypeID").val()=="0"){if($("#LotusServerPath").val()=="")return jAlert(display_PleaseEnterLotusServerPath,display_Alert,function(){$("#LotusServerPath").focus()}),!1;if($("#NFSFilePath").val()=="")return jAlert(display_PleaseEnterNFSFilePath,display_Alert,function(){$("#NFSFilePath").focus()}),!1}n.MailConfigID=f;n.CampaignID=k;n.MailBoxName=g;n.EmailID=it;n.UserID=rt;n.Password=ut;n.MailServerTypeID=ft;n.ServiceType=et;n.ScheduleInterval=ot;n.AutoReplyTemplate=st;n.AutoReplyEnableDisable=o;n.AutoDiscoveryPath=ht;n.LotusServerPath=ct;n.LotusDomainName=p;n.LotusDomainPrefix=w;n.sOutofOffice=l;n.bOutofOfficeEnabled=i;n.bOutLookEnabled=r;n.bTranslationEnabled=u;n.NFSFilePath=lt;n.WebEnabled=at;n.WebServerURL=vt;n.IsReadMail=s;n.UseServiceCredentialToPull=t;n.UseUserCredentialToSend=e;n.FolderType=d;n.Disable=h;n.bImpersonation=c;n.sImpersonationID=tt;n.sImpersonationIDType=nt;yt={MailConfigID:f};$("#load").show();a=$("#formSearchView input").val();$.ajax({type:"POST",url:ResourceLayout.partialURL+"TestConnection",data:{__RequestVerificationToken:a,objMailConfigurationViewModel:n},dataType:"json",success:function(n){var i,t,r,e,u,f;if(n.erorVal=="ERROR")jAlert(n.ErrorMessage,display_Alert);else{for($("#treeview").html()!=""?$("#treeview").data("kendoTreeView").dataSource.data(n.lst):$("#treeview").kendoTreeView({animation:!1,checkboxes:!0,dataSource:n.lst,check:onCheck,expand:onExpand}),i=n.Data,t=0;t<i.length;t++)for(r=0;r<$("#treeview").data("kendoTreeView").dataSource.view().length;r++)e=$("#treeview").data("kendoTreeView").dataSource,u=e.get(i[t].Id),u!=undefined&&(f=$("#treeview").data("kendoTreeView").dataSource.getByUid(u.uid),f&&f.set("checked",!0));$(".k-in").css("border-left-width: 10px;")}$("#load").hide()},error:function(n){jAlert(n.ErrorMessage,display_Alert);$("#load").hide()}})});$("#WebServerURL").keyup(function(){$("#chkDefaultWebServerURL").prop("checked",!1)});$("#chkDefaultWebServerURL").click(function(){var n=window.location.href,t=n.split("/")[0]+"//"+n.split("/")[2]+"/EMSService";$("#WebServerURL").val(t)});$("#grdSubFolder").kendoTooltip({filter:"td:nth-child(3)",position:"right",content:function(n){var t=$("#grdSubFolder").data("kendoGrid").dataItem(n.target.closest("tr"));return t.MailFolderPath}}).data("kendoTooltip");